{% extends "layout.html" %}

{% block title %}
    {% if keyword %}'{{ keyword }}' 뉴스 검색 결과{% else %}뉴스 검색{% endif %}
{% endblock %}

{% block content %}
<div class="bg-[var(--bg-card)] p-6 rounded-xl shadow-md mb-8 border border-[var(--border-color)]">
    <h1 class="text-3xl font-bold text-[var(--text-main)] mb-6">
        {% if keyword %}
            <span class="text-indigo-400">'{{ keyword }}'</span> 검색 결과
        {% else %}
            📰 IT/과학 최신 뉴스
        {% endif %}
    </h1>
    <form action="{{ url_for('news_page') }}" method="GET" class="flex rounded-lg shadow-sm">
        <input name="keyword" type="text"
               class="block w-full px-5 py-3 text-base text-[var(--text-main)] bg-[var(--bg-nav)] placeholder-[var(--text-secondary)] border border-[var(--border-color)] rounded-l-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
               placeholder="다른 키워드로 검색해보세요..." value="{{ keyword or '' }}">
        <button type="submit"
                class="p-4 bg-indigo-600 text-white rounded-r-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-[var(--bg-body)] focus:ring-indigo-500 transition duration-300 flex items-center justify-center">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
        </button>
    </form>
</div>

{% with messages = get_flashed_messages() %}
    {% if messages %}
        <div class="bg-red-500/20 border border-red-500 text-red-300 px-4 py-3 rounded-lg mb-6" role="alert">
            <p>{{ messages[0] }}</p>
        </div>
    {% endif %}
{% endwith %}

<div class="space-y-6">
    {% for news in results %}
    <a href="{{ news.link }}" target="_blank" rel="noopener noreferrer" class="block bg-[var(--bg-card)] rounded-xl shadow-md hover:shadow-xl hover:border-[var(--nav-hover-bg)] border border-[var(--border-color)] transition-all duration-300 p-6">
        <div class="flex flex-col sm:flex-row justify-between items-start">
            <div class="w-full sm:w-4/5">
                <h3 class="text-xl font-bold text-[var(--text-main)] mb-2">{{ news.title }}</h3>
                <span class="text-xs font-semibold inline-block py-1 px-2.5 leading-none text-center whitespace-nowrap align-baseline rounded-full 
                    {% if news.source == 'Nate News' %} bg-green-200 text-green-800 
                    {% elif news.source == 'BIG KINDS' %} bg-indigo-200 text-indigo-800 
                    {% endif %}">
                    {{ news.source }}
                </span>
            </div>
            
            <div class="text-sm font-medium text-[var(--text-secondary)] flex-shrink-0 ml-0 sm:ml-4 mt-2 sm:mt-0 text-left sm:text-right">
                <p>{{ news.press }}</p>
                <p>{{ news.date }}</p>
            </div>
        </div>
        <p class="text-[var(--text-secondary)] mt-3">{{ news.summary }}</p>
    </a>
    {% else %}
    <div class="text-center py-12 bg-[var(--bg-card)] rounded-xl shadow-md border border-[var(--border-color)]">
        <p class="text-[var(--text-secondary)] text-lg">표시할 뉴스 기사가 없습니다.</p>
    </div>
    {% endfor %}
</div>

{% if keyword and results %}
<div class="mt-10 flex justify-center items-center space-x-4">
    {% if page > 1 %}
        <a href="{{ url_for('news_page', keyword=keyword, page=page-1) }}" class="px-5 py-2 bg-[var(--bg-nav)] border border-[var(--border-color)] text-[var(--text-secondary)] rounded-lg hover:bg-[var(--nav-hover-bg)] transition-colors">
            ‹ 이전 페이지
        </a>
    {% else %}
        <span class="px-5 py-2 bg-[var(--bg-card)] text-[var(--text-secondary)] rounded-lg cursor-not-allowed border border-[var(--border-color)]">‹ 이전 페이지</span>
    {% endif %}

    <span class="font-bold text-lg px-4 py-2 bg-[var(--bg-card)] border border-[var(--border-color)] rounded-lg text-[var(--text-main)]">{{ page }}</span>

    <a href="{{ url_for('news_page', keyword=keyword, page=page+1) }}" class="px-5 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors">
        다음 페이지 ›
    </a>
</div>
{% endif %}
{% endblock %}